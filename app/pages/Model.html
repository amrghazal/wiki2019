<!-- index.html -->
{% extends "layout.html" %}
{% block content %} 
{% include "partials/header.nunjucks" %}
<h1 id="title" class="js-toc-ignore">Mathematical Models for Predicting the Long Term Health Benefits of using PRODEACC</h1>
<div id="body">
    <p>To better understand the long term health benefits of PRODEACC consumption, mathematical models of transformed <em>E. coli </em>Nissle 1917 colonies were developed. Unknown parameters were estimated using parameter optimization against data collected from in-vitro experiments. Once the models could predict the toxic metal bioaccumulation in a single colony, they could be integrated into existing models describing how lead and arsenic are bio-accumulated in the human body. By comparing the output of the modified body accumulation models to the output of the non-modified model, the long term effects of PRODEACC could be assessed. <strong>The modeling team has worked in conjunction with the lab group to reach this goal. In the beginning, it was planned to study the deaccumulating effects of PRODEACC on worms in order to assess the long term benefits. This id&eacute;a was discarded in favor of using computer models. The computer model has, therefore, had a huge impact on the lab work by alleviating this opportunity cost.</strong></p>
    <br>
<p>
To better understand this text it’s recommended to read the <a href="/Team:Lund/Description">project description</a> before continuing.
</p>
<h2 id="Modeling-growth-and-ion-accumulation in a singel colony">Bioaccumulation in a Bacteria Colony</h2>

<p>
    To model the growth, protein production and ion accumulation of a single colony, a system of seven differential equations was devised. Equation (1) and (2) describes the colony as a whole and the concentration of ions in its growth medium, whereas equation (3) - (7) describes the changes inside the average individual cell. A graphical representation of the equation can be found in animation 1. Short descriptions of the time-dependent variables can be found in table 1. Descriptions and approximate values of the parameters can be found in table 2. The initial parameters for the initial conditions can be found in table 3.
</p>

<video class="fig" autoplay muted loop playsinline>
    <source src="https://2019.igem.org/wiki/images/d/d8/T--Lund--colony-model.webm" type="video/webm">
    <source src="https://2019.igem.org/wiki/images/b/bb/T--Lund--colony-model.mp4" type="video/mp4">
</video>
<p class="fig" >Animation 1: A graphical representation of the rate of change of the ions and proteins described by equation (1) and (3)-(7). </p>

<h3></h3> id="derivatoin-of-equations">Derivation of Equations</h3>
<p>
The model was devised to simulate the colony in a number of conditions, with only the values of the parameters needed to be changed. For example, for the growth rate <i>k<sub>growth</sub></i> would most likely be lower in a gut environment compared to an <i>in-vitro</i> environment with good pH and no competition from other microbes.
<p>
<br>

<b>Equation (1)</b> describes the rate of change of the total number of living bacteria cells in the colony. The cells are assumed to divide at a constant rate <i>k<sub>growth</sub></i> after the lag phase is over. However, the exponential growth will not continue forever. At some point, the lack of energy will force the colony to stop dividing and will reach a stationary phase. Because of this, the term <i>−k<sub>growth</sub>&times N <sup>2</sup>/N<sub>max</sub></i> was introduced making the growth rate stagnate once <i>N</i> reaches <i>N<sub>max</sub></i> [1].
</p>
<br>
<p>
<b>Equation (2)</b> describes the rate of change of the total number of lead or arsenic ions in the gut (or growth medium). The rate of accumulation by the colony should be a function of the number of living cells <i>N</i>, as well as the number of transport proteins per cell. The working mechanisms for the lead/iron transporter pbrT are unknown [2].  The Michaelis–Menten equation was used in to represent the transport rate with the rational that a higher concentration of ions outside the cells would increase the probability of an ion finding its way through a transporter, but that the increment would give diminishing returns one more and more transporters work at their highest capacity [3].
</p>
<br>

<p>
<b>Equation (3)</b> describes the change in the number of mRNAs coding for the accumulation proteins and the transport proteins. The transcription rate <i>I<sub>tsc</sub></i> is assumed to be constant once the promoter has been induced. Then the mRNA will degrade att the kinetic rate <i>k<sub>RNA-deg</sub></i>.
</p>
<br>

<p>
<b>Equation (4)</b> describes the rate of change in the number of transport proteins per cell. The proteins are translated from the mRNAs at a kinetic rate <i>k<sub>tsl</sub></i>. The proteins are assumed to degrade at the kinetic rate <i>k<sub>pro-deg</sub></i>. The kinetic rate <i>-dN/dT/N</i> was introduced to take into account the effective degradation due to cell growth. Every time a cell divides the average number of proteins in one cell is halved. These kinetics apply the other proteins as well.
</p>
<br>
<p>
<b>Equation (5)</b> describes the rate change in the number of free accumulation proteins. Whenever an accumulation protein binds to an ion, the accumulation protein is no longer free. This rate is proportional to the number of accumulation proteins <i>AP<sub>free</sub></i> and the number of free ions in cytoplasm C. The kinetic rate <i>k<sub>capture</sub></i> was introduced to scale the rate of capture.
</p>
<br>

<p>
<b>Equation (6)</b> describes the rate of change in the number of occupied accumulation proteins, the proteins bound to an ion. The kinetics are similar to that of equation (5).
</p>

<p>
<b>Equation (7)</b> describes the rate of change in the number of free ions in the cytoplasm of one bacteria. Ions go from the gut into the cytoplasm, so the equation has the term from equation (2) but with different signs. Once the ions are bound to accumulation proteins, they are no longer free and are removed from the compartment with the same rate as it is removed from the free accumulation proteins compartment from equation (5). Whenever an occupied accumulation protein is degraded, the ion bound to it is released back to the cytoplasm, hence the positive term proportional to the number of occupied accumulation proteins. Last but not least, a negative term to take into account the fact that the number of ions in cytoplasm gets halved every time the bacteria divides. 
<br>

</p>


<p class ="math">
<dtex>\frac{dN}{dt} = k_{growth}\times N − k_{growth}\times\frac{N^2}{N_{max}}</dtex> 
<dtex>\frac{dG}{dt} = −\frac{V_{max}}{1+k_m/ \frac{G}{v_{gut}}}\times TP \times N</dtex> 
<dtex>\frac{d(mRNA)}{dt} = tsc − k_{RNA−deg} \times mRNA</dtex>
<dtex>\frac{d(TP)}{dt} = k_{tsl} \times mRNA − \frac{dN}{dt} \times \frac{TP}{N} − k_{pro−deg} \times TP </dtex>
<dtex>\frac{d(AP_{free})}{dt} = k_{tsl} \times mRNA − \frac{dN}{dt} \times \frac{AP_{free}}{N} − k_{pro−deg} \times AP_{free} − k_{capture} \times C \times AP_{free}</dtex>
<dtex>\frac{d(AP_{occupied})}{dt} = k_{capture} \times AP_{free} \times C − \frac{dN}{dt} \times \frac{AP_{occupied}}{N} − k_{pro−deg} \times AP_{occupied}</dtex>
<dtex>\frac{dC}{dt}= \frac{V_{max}}{1+k_m/ \frac{G}{v_{gut}}} \times TP − k_{capture} \times C \times AP_{free} + k_{pro−deg} \times  AP_{occupied} − \frac{dN}{dt} \times \frac{C}{N}  </dtex>
</p>

<button type="button" class="collapsible">Table 1: Time dependent variable</button>
<table class="collapsible-content">
  <tr>
    <th>Varible</th>
    <th>Description</th>
  </tr>
  <tr>
    <td><i>N</i></td>
    <td>The total number of living cells in the growth medium.</td>
  </tr>
  <tr>
    <td><i>G</i></td>
    <td>The total number of ions in the growth medium.</td>
  </tr>
  <tr>
      <td><i>mRNA</i></td>
      <td>The number of mRNAs coding for the ion-transport protein and the ions accumulation protein.</td>
  </tr>
  <tr>
      <td><i>TP</i></td>
      <td>The number of transport proteins expressed in a single cell.</td>
  </tr>
  <tr>
      <td><i>AP<sub>free</sub></i></td>
      <td>The number of free accumulation protein expressed inside a single cell.</td>
  </tr>
  <tr>
      <td><i>AP<sub>occupied</sub></i></td>
      <td>The number of accumulation protein expressed a single cell, that are bound to an ion.</td>
  </tr>
  <tr>
      <td><i>C</i></td>
      <td>The number of free ions inside the cytoplasm of a single cell.</td>
  </tr>
</table>
<p></p>
<button type="button" class="collapsible">Table 2: Parameter descriptions</button>
<table class="collapsible-content">
  <tr>
    <th>Parameter</th>
    <th>Description</th>
    <th>Estimated Value</th>
    <th>Unit</th>
    <th>Notes and refereces</th>
  </tr>
  <tr>
      <td><i>V<sub>cell</sub></i></td>
      <td>Volume of <i>E.coli</i> cell.</td>
      <td>1.5e-10</td>
      <td>Litre</td>
      <td><a href="https://link.springer.com/article/10.1007%2Fs00253-013-5377-9">Allen C. S. Yu et al 2014</a></td>
  </tr>
  <tr>
    <td><i>V<sub>gut</sub></i></td>
    <td>Volume of gut</td>
    <td>1.2</td>
    <td>Litre</td>
    <td><a href="https://www.sciencedirect.com/science/article/pii/S1382668917303241?via%3Dihub"></a>Eric Dede 2018</td>
  </tr>
  <tr>
    <td><i>tsc</i></td>
    <td>Transcripton rate</td>
    <td>900</td>
    <td>mRNA/h</td>
    <td>Genes VIII, Lewin 2004. (Original unit is mRNA/min)</td>
  </tr>
  <tr>
      <td><i>k<sub>tsl</sub></i></td>
      <td>Translation rate</td>
      <td></td>
      <td>/h</td>
      <td><a href="https://www.ncbi.nlm.nih.gov/pubmed/3071683?ordinalpos=3&itool=EntrezSystem2.PEntrez.Pubmed.Pubmed_ResultsPanel.Pubmed_DefaultReportPanel.Pubmed_RVDocSum">Ehrenberg and Kurland, 1988</a></td>
  </tr>
  <tr>
      <td><i>k<sub>RNA-deg</sub></i></td>
      <td>RNA degradation rate</td>
      <td>8.3177</td>
      <td>/h</td>
      <td><a href="http://book.bionumbers.org/how-fast-do-rnas-and-proteins-degrade/">Bionumbers.org</a>, calculated from mRNA’s half life of e.coli which is  about 5 minutes.</td>
  </tr>
  <tr>
      <td><i>k<sub>pro-deg</sub></i></td>
      <td>Protein degradation rate</td>
      <td>1.0397</td>
      <td>/h</td>
      <td><a href="http://book.bionumbers.org/how-fast-do-rnas-and-proteins-degrade/">Bionumbers.org</a>, calculated from mean protein’s half life in yeast which is about 40 minutes. </td>
  </tr>
</table>
<p></p>
<button type="button" class="collapsible">Table 3: Initial conditions</button>
<table class="collapsible-content">
    </table>
<p></p>
<h3 id="parameter-optimization">Parameter Optimization</h3>
<p>
    Values for the parameters that couldn't be found in the literature were estimated using data acquired from experiments. The model could be fitted to the data with the help of optimization algorithms. The acquired parameter values were the ones that yielded the lowest cost from a linear loss function. To find the lowest cost adaptive particle swarm algorithm was used[4]. Particle swarm optimization has been used with good efficiency for other non-linear ODE-parameter estimation for biological systems, where there's a big solution space [5]. 
</p>
<p>
    Particle swarm optimization (PSO) is an optimization algorithm inspired by the movement of a group of organisms, for example, a flock of birds or a shoal of fish. An upper and a lower bound to the search space is given and the algorithm initializes by uniformly distributing the particles/organisms in the space. The solution is calculated for each particle. Each particle then moves in the search space in the direction of the vector sum of is own previous best solution and the group’s best solution. The length at which the particles move varies from different flavors of the algorithm [5]. 
</p>
<img class="fig-small" src="https://2019.igem.org/wiki/images/9/90/T--Lund--pso.gif" alt="">
<p class="fig">Animation 2: Animation showing how particles navigate the solution space and converging on the global minimum. Courtesy: Ephramac, <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a></p>
<p>Data acquired from wetlab was used in order to derive the correct values for the colony model parameters. It’s important to keep in mind that the parameters are different in different conditions. Which parameter values that could be aquired from which measurement can be seen in table 4.
</p>
<br>
<p class="fig">Table 4: The value of the parameters above can be found using the data from the experiments above.</p>
<h2 id="sensitivity-analysis">Sensitivity Analysis</h2>
<p>When having a complex system of inputs and outputs, it’s difficult to know which inputs have more effects on the outputs. And we want to know that because determining the importance of each parameter for our colony uptake model can give insight into what we should improve if we want the colony to be more effective in accumulating the toxic metal. Several parameters in the colony model have the potential to be critical, such as  <i>k<sub>CA</sub></i> (the capture rate of accumulation protein), <i>k<sub>m</sub></i> and <i>V<sub>max</sub></i> (the constants for transport protein), or <i>k<sub>growth</sub></i> and <i>N<sub>max</sub></i> (the growth rate and the maximum concentration of the bacteria colony), etc. So knowing the importance of these parameters for the de-accumulating effect, we also know which part of our colony we should improve, either the accumulation protein, the transport protein or the survival of bacteria itself. In order to do that, we carry out what is called sensitivity analysis on our model.  </p>
<p>In particular, we performed a global sensitivity analysis (GSA) method called Sobol. It is a variance-based analysis. GSA allows us to vary all the parameters simultaneously to evaluate their relative contribution to the model outputs as well as their interaction with each other [6]. Unlike local sensitivity analysis, which only allows for the evaluation of one parameter at a time. The steps for Sobol analysis is described in the figure below.</p>
</p> 
<h2 id="body-uptake">Bioaccumulation in the Human Body</h2>
<p>
The human body uptake models show how much toxic metal accumulates in different organs of the body. Each of them consists of a system of differential equations, where each differential equation describes the rate of change of the amount of toxic metal in one compartment. A compartment can be either an organ or an excretion pool. We implemented the body uptake models for Arsenic and Lead based on a paper by Eric Dede published in 2018 [1]. We then modified the models by adding differential equations describing how the bacteria colony is expected to interact with the toxic metal in the human body.
</p>
<h3 id="arsenic">Arsenic</h3>
<p>
In arsenic body uptake model, there are 12 compartments that are taken into consideration as seen in figure x1. The figure describes the dynamics between the compartments with first order rate constants. A first-order reaction has a rate proportional to the concentration of one reactant [2], meaning the higher the concentration of a toxic metal is, the faster it is being transferred to other compartments.
</p>
<img class="fig" src="https://2019.igem.org/wiki/images/8/81/T--Lund--arsenic-model.svg" alt="">
<p class="fig">Figure 2: Overview of compartements and their relations in the arsenic body uptake model.</p>
<p>
The model also takes into account that arsenic exists in different forms in the human body. They can be inorganic ions, such as As(III) or As(V), or organic forms such as monomethylarsenic acid (MMA) or dimethylarsenic acid (DMA). There are reactions taking place in the body such that one form of arsenic is converted to another so extra terms are added to the differential equations for that. Since we model for 12 compartments and 4 forms of arsenic, there’s a total of 48 equations in the system of differential equations, 12 for each of the form of arsenic. 
</p>
<p>
We then couple the colony model from above to this human body uptake model by adding a term in the gut compartment that represents the rate of ions being absorbed by the colony of bacteria. 
</p>
<h3 id="lead">Lead</h3>
<p>The body uptake model for lead was originally developed during the 1990s[3][4][5], it was later modified in 2018[1]. There are seven compartments, as seen in figure x. To integrate the colony uptake model into the body uptake it first had to be modified. 
</p>
<img class="fig" src="https://2019.igem.org/wiki/images/f/f0/T--Lund--lead.svg" alt="">
<p class="fig">Figure 3: Overview of compartements and their relations in non-modfied the lead body uptake model.</p>
<p>The original-, modified- and colony integrated versions of the the GI-tract-liver dynamics can be seen in figure x. In the original version the oral lead intake was described as a constant rate IRgi. The rate being absorbed by the liver was described as a fraction of the daily intake. In order to integrate the colony uptake model, these dynamics had to be replaced by first order kinetic rates, similar to the body uptake model for arsenic. The daily intake IRgi was then set as an initial condition for the GI tract differential equation. The model could then be solved piecewise, each time with the initial condition G(0) = IRgi. The values for kGF and kGL could not be found in literature. To find the values for these rates, while preserving the models predictability, the parameter optimization as described earlier was used. 
</p>
<p>After the modification, the colony uptake model could be integrated in the lead uptake model, just as in the case with arsenic.
</p>
<img class="fig" src="https://2019.igem.org/wiki/images/3/34/T--Lund--model-mod.svg" alt="">
<p class="fig">Figure 3: Overview of the original liver-gut compartment, the modified liver-gut compartement, and the colony model integrated liver-gut compartement.</p>

<h2 class="integrate">Integration of colony model into human body model</h2>
<p>The colony models could be integrated into the human body uptake models by adding the colony as a compartment connected to the gut compartment. This way the bacteria colony will compete against the liver when absorbing the metals from the gut.
</p>
<h3 id="arsenic2">Arsenic</h3>
<p>The colony model was integrated by adding the colony model as a compartment resulting in a model that can be overview in figure 4.
</p>
<img class="fig" src="https://2019.igem.org/wiki/images/5/5a/T--Lund--arsenic-model-integrated.svg" alt="">
<p class="fig">Figure 4: An overview of the bacteria colony integrated human body uptake model for arseic.</p>

<h3 id="lead2">Lead</h3>
<p>To integrate the colony uptake model into the body uptake it first had to be modified. The original-, modified- and colony integrated versions of the GI-tract-liver dynamics can be seen in figure x. In the original version, the oral lead intake was described as a constant rate IRgi. The rate being absorbed by the liver was described as a fraction of the daily intake. To integrate the colony uptake model, these dynamics had to be replaced by first-order kinetic rates, similar to the rates found in the body uptake model for arsenic. The daily intake IRgi was then set as an initial condition for the GI tract differential equation. The model could then be solved piecewise, each time with the initial condition G(0) = IRgi. The values for kGF and kGL could not be found in the literature. To find the values for these rates, while preserving the model's predictability, the parameter optimization, as described earlier, was used. 
</p>
<p class="maths">
<dtex>\frac{dG}{dt} = IR_{gi} - A_{gi} \times IR_{gi} - (1-A_{gi}) \times IR_{gi} = 0 </dtex> 
<dtex>\frac{dG}{dt} = -k_{GF} \times IR_{gi} - k_{GB} \times G </dtex> 
</p>
<img class="fig" src="https://2019.igem.org/wiki/images/1/1c/T--Lund--lead-model-integrated.svg" alt="">
<p class="fig">Figure 5: An overview of the bacteria colony integrated human body uptake model for lead.</p>





</div>
{% include "partials/footer.nunjucks" %}

{% endblock %}
